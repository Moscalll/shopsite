<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle} ?: '首页'">首页</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/custom.css}">
</head>

<body>
    <div th:replace="index/fragments :: navbar"></div>

    <main class="container-fluid px-0">
        <!-- 横幅滚动大图 -->
        <section class="mb-5">
            <div id="homeCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#homeCarousel" th:each="banner, iterStat : ${banners}"
                        th:data-bs-slide-to="${iterStat.index}" th:classappend="${iterStat.first} ? 'active' : ''"
                        aria-current="true" aria-label="Slide"></button>
                </div>
                <div class="carousel-inner">
                    <div th:each="banner, iterStat : ${banners}"
                        th:classappend="${iterStat.first} ? 'carousel-item active' : 'carousel-item'">
                        <img th:src="${banner.imageUrl}" class="d-block w-100" th:alt="${banner.title}"
                            style="height: 400px; object-fit: cover;">
                        <div class="carousel-caption d-none d-md-block"
                            style="background-color: rgba(255, 255, 255, 0.8); border-radius: 5px; padding: 20px;">
                            <h3 th:text="${banner.title}" style="color: #333;">标题</h3>
                            <p th:text="${banner.description}" style="color: #666;">描述</p>
                        </div>
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#homeCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#homeCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </section>

        <div class="container py-4">
            <!-- 分类栏 -->
            <section class="mb-5">
                <div class="row mb-4">
                    <div class="col-12">
                        <h2 class="text-muji-dark text-center">| 商品分类 |</h2>
                        <hr class="w-25 mx-auto" style="border-top: 2px solid #A5B699;">
                    </div>
                </div>
                <div class="row g-4">
                    <div class="col-lg-3 col-md-3 col-sm-6 col-6" th:each="category : ${categories}">
                        <a th:href="@{/products?categoryId={id}(id=${category.id})}"
                            class="text-decoration-none text-center d-block">
                            <div class="card border-0 shadow-sm h-100 hover-shadow">
                                <div class="card-body p-3">
                                    <img th:src="${category.imageUrl ?: '/images/category-placeholder.jpg'}"
                                        class="img-fluid rounded mb-2" th:alt="${category.name}"
                                        style="width: 100%; height: 120px; object-fit: cover; background-color: #f5f5f5;">
                                    <h6 class="card-title mb-0 text-muji-dark" th:text="${category.name}">分类名称</h6>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-12" th:if="${#lists.isEmpty(categories)}">
                        <p class="text-center text-muted">暂无分类</p>
                    </div>
                </div>
            </section>

            <!-- 新品上市 -->
            <section class="mb-5">
                <div class="row mb-4">
                    <div class="col-12 d-flex justify-content-between align-items-center">
                        <h2 class="text-muji-dark mb-0">| 新品上市 |</h2>
                        <a th:href="@{/new-arrivals}" class="btn btn-light" style="border: 1px solid #A5B699;">
                            查看全部 <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                    <div class="col-12">
                        <hr class="w-25" style="border-top: 2px solid #A5B699;">
                    </div>
                </div>
                <div class="row g-4">
                    <div class="row g-4">
                        <div class="col-lg-3 col-md-4 col-sm-6" th:each="product : ${newArrivals}"
                            th:if="${product.isAvailable}">
                            <div class="card h-100 shadow-sm border-0">
                                <img th:src="${product.imageUrl ?: '/images/placeholder.jpg'}" class="card-img-top"
                                    th:alt="${product.name}" style="height: 200px; object-fit: cover;">
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title" th:text="${product.name}">商品名称</h5>
                                    <p class="card-text text-danger fw-bold mb-2">
                                        ¥<span
                                            th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 2, 'POINT')}">99.00</span>
                                    </p>
                                    <p class="card-text text-muted small mb-auto">库存: <span
                                            th:text="${product.stock}">10</span></p>
                                    <a th:href="@{/product/{id}(id=${product.id})}"
                                        class="btn btn-outline-dark btn-sm mt-2">查看详情</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-12" th:if="${#lists.isEmpty(newArrivals)}">
                            <p class="text-center text-muted">暂无新品</p>
                        </div>
                    </div>
            </section>

            <!-- 热销排行榜 -->
            <section class="mb-5">
                <div class="row mb-4">
                    <div class="col-12 d-flex justify-content-between align-items-center">
                        <h2 class="text-muji-dark mb-0">| 热销排行榜 |</h2>
                        <a th:href="@{/top-selling}" class="btn btn-light" style="border: 1px solid #A5B699;">
                            查看全部 <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                    <div class="col-12">
                        <hr class="w-25" style="border-top: 2px solid #A5B699;">
                    </div>
                </div>
                <div class="row g-4">
                    <div class="col-lg-3 col-md-4 col-sm-6" th:each="product, iterStat : ${topSelling}"
                        th:if="${product.isAvailable}">
                        <div class="card h-100 shadow-sm border-0">
                            <div class="position-relative">
                                <span class="badge bg-danger position-absolute top-0 start-0 m-2"
                                    th:if="${iterStat.index < 3}">
                                    第 <span th:text="${iterStat.index + 1}">1</span> 名
                                </span>
                                <img th:src="${product.imageUrl ?: '/images/placeholder.jpg'}" class="card-img-top"
                                    th:alt="${product.name}" style="height: 200px; object-fit: cover;">
                            </div>
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title" th:text="${product.name}">商品名称</h5>
                                <p class="card-text text-danger fw-bold mb-2">
                                    ¥<span
                                        th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 2, 'POINT')}">99.00</span>
                                </p>
                                <p class="card-text text-muted small mb-auto">库存: <span
                                        th:text="${product.stock}">10</span></p>
                                <a th:href="@{/product/{id}(id=${product.id})}"
                                    class="btn btn-outline-dark btn-sm mt-2">查看详情</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12" th:if="${#lists.isEmpty(topSelling)}">
                        <p class="text-center text-muted">暂无热销商品</p>
                    </div>
                </div>
            </section>

            <!-- 分类展示 -->
            <section class="mb-5" th:each="category : ${categories}">
                <div class="row mb-4">
                    <div class="col-12">
                        <h2 class="text-muji-dark" th:text="'| ' + ${category.name} + ' |'">| 分类名称 |</h2>
                        <hr class="w-25" style="border-top: 2px solid #A5B699;">
                    </div>
                </div>
                <div class="row g-4">
                    <div class="col-lg-3 col-md-4 col-sm-6" th:each="product : ${categoryProductsMap[category.id]}"
                        th:if="${product.isAvailable}">
                        <div class="card h-100 shadow-sm border-0">
                            <img th:src="${product.imageUrl ?: '/images/placeholder.jpg'}" class="card-img-top"
                                th:alt="${product.name}" style="height: 200px; object-fit: cover;">
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title" th:text="${product.name}">商品名称</h5>
                                <p class="card-text text-danger fw-bold mb-2">
                                    ¥<span
                                        th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 2, 'POINT')}">99.00</span>
                                </p>
                                <p class="card-text text-muted small mb-auto">库存: <span
                                        th:text="${product.stock}">10</span></p>
                                <a th:href="@{/product/{id}(id=${product.id})}"
                                    class="btn btn-outline-dark btn-sm mt-2">查看详情</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-12" th:if="${#lists.isEmpty(categoryProductsMap[category.id])}">
                        <p class="text-center text-muted" th:text="'暂无' + ${category.name} + '商品'">暂无商品</p>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-12 text-center">
                        <a th:href="@{/products?categoryId={id}(id=${category.id})}" class="btn btn-light"
                            style="border: 1px solid #A5B699;">
                            查看全部 <span th:text="${category.name}">分类</span> <i class="bi bi-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </section>



        </div>
    </main>

    <div th:replace="index/fragments :: footer"></div>
    <script th:src="@{/js/bootstrap.bundle.min.js}"></script>
</body>

</html>